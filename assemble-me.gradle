def getCurrentVariantTask() {
  def imlFile = project.file("${project.name}.iml")
  if (!imlFile.exists()) {
    return;
  }

  def xml = new XmlParser().parse(imlFile)
  def selectedBuildVariant = xml.depthFirst().find { node ->
    node.hasProperty("name") && node.@name == 'SELECTED_BUILD_VARIANT'
  }?.@value
  def taskName = "assemble${selectedBuildVariant.capitalize()}"
  println "task to be executed: $taskName"
  return taskName
}

task assembleMe(dependsOn: getCurrentVariantTask()) {}
